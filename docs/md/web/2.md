# 马赛克效果

所有者: Stan

```jsx
<canvas id="canvas"></canvas>

<script>
    const canvas = document.getElementById("canvas");
    const width = 300;
    const height = 300;
    canvas.width = width * 3;
    canvas.height = height;
    const ctx = canvas.getContext("2d");

    const img = new Image();
    img.src = "./image/1.jpg";
    img.onload = () => {
        ctx.drawImage(img, 0, 0, width, height);

        const imageData = ctx.getImageData(0, 0, width, height);
        const data = imageData.data;

        // 色块大小
        let size = 5;

        ctx.fillRect(width * 2, 0, width, height);

        // 降低采样
        for (let y = 0; y < height; y += size) {
            for (let x = 0; x < width; x += size) {
                // 索引值
                const i = (y * width + x) * 4;

                const [r, g, b] = [data[i], data[i + 1], data[i + 2]];

                ctx.fillStyle = `rgb(${r}, ${g}, ${b})`;
                ctx.fillRect(x + width, y, size, size);

                ctx.beginPath();
                ctx.arc(x + width * 2, y, size / 2, 0, Math.PI * 2);
                ctx.fill();
            }
        }
    };
</script>
```

![mosaic.png](/md/web/image/gray-image.png)